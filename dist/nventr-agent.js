function init(){let r=document.createElement("div"),d=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("iframe"),p=document,u=36,e="NONE",h="COLLAPSED",w="FULLSCREEN",i=[],m={visible:!1,rendered:!1,onRendered:null,onAction:null,onActions:null,webhookAccessToken:null,metadata:null,height:448,width:352,margin:16,radius:4,zIndex:10,windowState:e},g=(window.addEventListener("message",function(e){if(e&&e.data&&"nventr-agent"===e.data.source){let n=e=>({name:e.name,value:e.value?JSON.parse(e.value):null});let a=(t,n)=>{i.forEach(e=>{e.name===t&&e.callback(n)}),m.onAction&&m.onAction(t,n)};switch(e.data.type){case"action":if(!e.data.payload||!e.data.payload.name)return!1;var o=n(e.data.payload);a(o.name,o.value);break;case"actions":if(!e.data.payload||!e.data.payload.length)return!1;o=e.data.payload.map(e=>n(e)).filter(e=>e&&e.name);if(!o.length)return!1;m.onActions&&m.onActions(o),o.forEach(({name:e,value:t})=>{a(e,t)});break;case"onBeforeNewConversation":break;case"rendered":let t=e.data.payload;["margin","radius","height","width","zIndex"].forEach(e=>{e in t&&null!==t[e]&&!isNaN(t[e])&&(m[e]=parseInt(t[e]))}),m.rendered=!0,m.onRenderedCallback&&m.onRenderedCallback(),m.webhookAccessToken&&y(m.webhookAccessToken),m.metadata&&b(m.metadata),C()}}}),(t,n)=>Object.keys(n).forEach(e=>t.style[e]=n[e])),v=e=>{e.preventDefault(),e.stopPropagation()},x=e=>{if(m.windowState!==w){v(e);let a=e.clientX,o=e.clientY,i=m.windowState===h?u:m.height,t=(c.style.pointerEvents="none",d.onmousedown=null,e=>{v(e);let t=r.offsetTop-(o-e.clientY),n=r.offsetLeft-(a-e.clientX);a=e.clientX,o=e.clientY,t<0&&(t=0),(n=n<0?0:n)+m.width>window.innerWidth&&(n=window.innerWidth-m.width),t+i>window.innerHeight&&(t=window.innerHeight-i),r.style.top=t+"px",r.style.left=n+"px"}),n=e=>{v(e),p.removeEventListener("mouseup",n),p.removeEventListener("mousemove",t),p.removeEventListener("mouseleave",n),d.onmousedown=x,c.style.pointerEvents="auto"};p.addEventListener("mouseup",n),p.addEventListener("mousemove",t),p.addEventListener("mouseleave",n),e.preventDefault}},t=()=>{r.style.height=u+"px",r.style.width=m.width+"px",r.style.top=null,r.style.left=null,r.style.bottom=m.margin+"px",r.style.right=m.margin+"px",f(h)},n=()=>{r.style.height=m.height+"px",r.style.width=m.width+"px",r.style.top=null,r.style.left=null,r.style.bottom=m.margin+"px",r.style.right=m.margin+"px",f(e)},a=()=>{r.style.width="auto",r.style.height="auto",r.style.width="auto",r.style.height="auto",r.style.top=m.margin+"px",r.style.left=m.margin+"px",r.style.bottom=m.margin+"px",r.style.right=m.margin+"px",f(w)},y=e=>{m.webhookAccessToken=e,m.rendered&&c.contentWindow.postMessage({source:"nventr-agent",type:"webhookAccessToken",payload:e},"*")},o=e=>{m.setConversationUuid=e,m.rendered&&c.contentWindow.postMessage({source:"nventr-agent",type:"conversationUuid",payload:e},"*")},b=e=>{m.metadata=e,m.rendered&&c.contentWindow.postMessage({source:"nventr-agent",type:"metadata",payload:e},"*")},f=e=>{m.windowState=e,c.contentWindow.postMessage({source:"nventr-agent",type:"windowState",payload:e},"*")},A=()=>{m.windowState=m.windowState===h?e:h,(m.windowState===h?t:n)()},k=()=>{m.windowState=m.windowState===w?e:w,(m.windowState===w?a:n)()},E=()=>{m.visible||(r.animate([{opacity:0},{opacity:1}],{duration:800,easing:"linear",fill:"forwards"}),m.visible=!0)},S=()=>{r.getAnimations().forEach(e=>e.cancel()),r.remove(),m.rendered=!1},C=()=>{switch(g(r,{bottom:m.margin+"px",right:m.margin+"px",borderRadius:m.radius+"px",height:m.height+"px",width:m.width+"px","z-index":m.zIndex}),m.windowState){case h:t();break;case w:a()}E()};var R=()=>{var e=document.getElementById("nventr-agent");if(!e)return{};let o=new URL(e.src);e=(e,t)=>{let n=!1;if(o.searchParams.has(e)){var a=o.searchParams.get(e);switch(a){case"":case"1":case"true":n=!0;break;case"false":case"0":n=!1;break;default:null===t&&(n=a)}""===o.searchParams.get(e)&&(n=!0)}else n=t;return n};return{id:e("id",null),dev:e("dev",!1),uat:e("uat",!1),fullscreen:e("fullscreen",!1),collapse:e("collapse",!1),render:e("render",!0),margin:e("margin",null),zIndex:e("zIndex",null),radius:e("radius",null),theme:e("theme",null),conversationUuid:e("conversationUuid",null)}};let L=(e={})=>{var t=e.dev||!1,n=e.uat||!1,a=e.id||e.agentAccessKey;if(!a)return console.warn("Nventr Agent warning. No agent access key provided. Please add the id parameter or use nventrAgent.render({ id: [AGENT ACCESS KEY] })."),!1;S(),e.onRendered&&(m.onRenderedCallback=e.onRendered),e.webhookAccessToken&&(m.webhookAccessToken=e.webhookAccessToken),e.metadata&&(m.metadata=e.metadata),e.onAction&&(m.onAction=e.onAction),e.onActions&&(m.onActions=e.onActions),e.margin&&(m.margin=e.margin),e.radius&&(m.radius=e.radius),e.height&&(m.height=e.height),e.width&&(m.width=e.width),e.zIndex&&(m.zIndex=e.zIndex),e.conversationUuid&&(m.conversationUuid=e.conversationUuid),r.id="nventrAgentWrapper_"+Date.now(),g(r,{...U.wrapper,bottom:m.margin+"px",right:m.margin+"px",borderRadius:m.radius+"px",height:m.height+"px",width:m.width+"px"}),g(d,{...U.handle,width:m.width-64+"px"}),d.onmousedown=x,g(s,U.collapseButton),s.onclick=A,g(l,U.fullscreenButton),l.onclick=k,g(c,{...U.iframe,borderRadius:m.radius+"px"});var o=[],o=(e.theme&&o.push("theme="+e.theme),e.radius&&o.push("radius="+e.radius),e.conversationUuid&&o.push("conversationUuid="+e.conversationUuid),o.length?"&"+o.join("&"):"");let i="https://agent.inventr.ai?agentAccessKey="+a+o;return n?i="https://uat-agent.inventr.ai?agentAccessKey="+a+o:t&&(i="https://dev-agent.inventr.ai?agentAccessKey="+a+o),c.src=i,c.allow="microphone",c.allowusermedia="true",r.appendChild(c),r.appendChild(d),r.appendChild(s),r.appendChild(l),document.body.appendChild(r),!0===e.collapse?m.windowState=h:!0===e.fullscreen&&(m.windowState=w),!0},U={wrapper:{backgroundColor:"rgba(0, 0, 0, 0)",position:"fixed",zIndex:"10",opacity:"0",boxShadow:"0px 1px 10px 1px rgba(0, 0, 0, .2)",borderWidth:"0px",overflow:"hidden"},handle:{cursor:"grab",position:"absolute",top:"0px",height:"32px",opacity:"0"},collapseButton:{cursor:"pointer",position:"absolute",top:"0px",right:"32px",height:"32px",width:"32px",opacity:"0"},fullscreenButton:{cursor:"pointer",position:"absolute",top:"0px",right:"0px",height:"32px",width:"32px",opacity:"0"},iframe:{position:"absolute",height:"100%",width:"100%",top:"0px",right:"0px",bottom:"0px",left:"0px",borderRadius:"4px",borderWidth:"0px",overflow:"hidden"}};return R().render&&L(R()),{render:e=>{L(e)},setWebhookAccessToken:e=>y(e),removeWebhookAccessToken:()=>y(null),setConversationUuid:e=>o(e),removeConversationUuid:()=>o(null),addActionListener:(e,t)=>{let n={name:e,callback:t};return i.push(n),{remove:()=>{var e=i.indexOf(n);i.splice(e,1)}}},onAction:e=>{m.onAction=e},onActions:e=>{m.onActions=e},onRendered:e=>{m.onRenderedCallback=e,m.rendered&&m.onRenderedCallback()},restore:()=>n(),collapse:()=>t(),fullscreen:()=>a(),show:()=>E(),hide:()=>{m.visible&&(r.animate([{opacity:1},{opacity:0}],{duration:800,easing:"linear",fill:"forwards"}),m.visible=!1)},margin:e=>{m.margin=e},radius:e=>{m.radius=e},theme:e=>{m.theme=e},remove:()=>S()}}let nventrAgent=window.nventrAgent||init();window.nventrAgent=nventrAgent;export default window.inventrAgent=nventrAgent;