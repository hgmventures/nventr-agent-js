function init(){let p=document.createElement("div"),c=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),l=document.createElement("div"),h=document.createElement("iframe"),o=document,n="NONE",s="COLLAPSED",u="FULLSCREEN";let t="FAB";let a={collapsed:{MINIMIZED:{height:36},[t]:{height:56,width:56,borderRadius:16,margin:16}}},i=[],w={visible:!1,rendered:!1,onRendered:null,onAction:null,onActions:null,webhookAccessToken:null,metadata:null,height:448,width:352,margin:16,radius:16,zIndex:10,windowState:n,collapsedType:t};window.addEventListener("message",function(e){if(e&&e.data&&"nventr-agent"===e.data.source){let n=e=>({name:e.name,value:e.value?JSON.parse(e.value):null});let o=(t,n)=>{i.forEach(e=>{e.name===t&&e.callback(n)}),w.onAction&&w.onAction(t,n)};switch(e.data.type){case"action":if(!e.data.payload||!e.data.payload.name)return!1;var a=n(e.data.payload);o(a.name,a.value);break;case"actions":if(!e.data.payload||!e.data.payload.length)return!1;a=e.data.payload.map(e=>n(e)).filter(e=>e&&e.name);if(!a.length)return!1;w.onActions&&w.onActions(a),a.forEach(({name:e,value:t})=>{o(e,t)});break;case"onBeforeNewConversation":break;case"rendered":let t=e.data.payload;["margin","radius","height","width","zIndex"].forEach(e=>{e in t&&null!==t[e]&&!isNaN(t[e])&&(w[e]=parseInt(t[e]))}),w.rendered=!0,w.onRenderedCallback&&w.onRenderedCallback(),w.webhookAccessToken&&E(w.webhookAccessToken),w.metadata&&C(w.metadata),z()}}});var e=()=>{var e=window.innerWidth,t=window.innerHeight;e===w.windowWidth&&t===w.windowHeight||(w.windowWidth=e,w.windowHeight=t,w.rendered&&w.windowState===n&&f({resetPosition:!1}))};window.addEventListener("resize",e),window.addEventListener("DOMContentLoaded",e);let g=(t,n)=>Object.keys(n).forEach(e=>t.style[e]=n[e]),m=e=>{e.preventDefault(),e.stopPropagation()},x=e=>{if(w.windowState!==u&&(w.windowState!==s||w.collapsedType!==t)){m(e);let i=e.clientX,r=e.clientY,d=p.offsetHeight,l=p.offsetWidth,s=w.margin,t=(h.style.pointerEvents="none",c.onmousedown=null,e=>{m(e);let t=p.offsetTop-(r-e.clientY),n=p.offsetLeft-(i-e.clientX),o=(i=e.clientX,r=e.clientY,t<s&&(t=s),!1),a=!1;(n=n<s?s:n)+l>=window.innerWidth-s&&(n=window.innerWidth-l-s,o=!0),t+d>=window.innerHeight-s&&(t=window.innerHeight-d-s,a=!0),o&&a?g(p,{bottom:s+"px",right:s+"px",top:null,left:null}):g(p,{top:t+"px",left:n+"px",bottom:null,right:null})}),n=e=>{m(e),o.removeEventListener("mouseup",n),o.removeEventListener("mousemove",t),o.removeEventListener("mouseleave",n),c.onmousedown=x,h.style.pointerEvents="auto"};o.addEventListener("mouseup",n),o.addEventListener("mousemove",t),o.addEventListener("mouseleave",n),e.preventDefault}},v="0px 1.5px 5px 0px rgba(0,0,0,0.14), 0px 3px 14px 2px rgba(0,0,0,0.12), 0px 8px 10px 1px rgba(0,0,0,0.20)",b=()=>{var e=a.collapsed[w.collapsedType];W(),w.collapsedType===t?(g(p,{height:e.height+"px",width:e.width+"px",borderRadius:e.borderRadius+"px",bottom:w.margin+"px",right:w.margin+"px",top:null,left:null}),A()):g(p,{height:e.height+"px",width:w.width+"px",bottom:w.margin+"px",right:w.margin+"px",top:null,left:null}),g(p,{boxShadow:"0px 1.5px 5px 0px rgba(0,0,0,0.14), 0px 3px 14px 2px rgba(0,0,0,0.12), 0px 8px 10px 1px rgba(0,0,0,0.20)"}),L(s)},f=(e={})=>{var{resetPosition:e=!0}=e;e&&g(p,{bottom:w.margin+"px",right:w.margin+"px",top:null,left:null});let{height:o,width:a,margin:i}=w;var{innerHeight:r,innerWidth:d}=window;switch(p.style.bottom&&p.style.right?"bottom-right":"top-left"){case"top-left":o=w.height,a=w.width;var{offsetTop:l,offsetLeft:s}=p;let e=!1,t=l,n=s;if(l+o+i>r&&((t=r-o-i)<i&&(t=i),e=!0),s+a+i>d&&((n=d-a-i)<i&&(n=i),e=!0),e){if(t+o+i>=r&&n+a+i>=d)return g(p,{bottom:i+"px",right:i+"px",top:null,left:null});g(p,{bottom:null,right:null,top:t+"px",left:n+"px"})}o+2*i>r&&(o=r-2*i),a+2*i>d&&(a=d-2*i);break;case"bottom-right":o+2*i>r&&(o=r-2*i),a+2*i>d&&(a=d-2*i)}g(p,{height:o+"px",width:a+"px",boxShadow:v}),e&&W(),k(),L(n)},y=()=>{p.style.width="auto",p.style.height="auto",p.style.width="auto",p.style.height="auto",p.style.top=w.margin+"px",p.style.left=w.margin+"px",p.style.bottom=w.margin+"px",p.style.right=w.margin+"px",p.style.boxShadow=v,k(),L(u)},A=()=>{w.collapsedType===t?l.style.display="block":l.style.display="none"},k=()=>{l.style.display="none"},E=e=>{w.webhookAccessToken=e,w.rendered&&h.contentWindow.postMessage({source:"nventr-agent",type:"webhookAccessToken",payload:e},"*")},S=e=>{w.setConversationUuid=e,w.rendered&&h.contentWindow.postMessage({source:"nventr-agent",type:"conversationUuid",payload:e},"*")},C=e=>{w.metadata=e,w.rendered&&h.contentWindow.postMessage({source:"nventr-agent",type:"metadata",payload:e},"*")},L=e=>{w.windowState=e,h.contentWindow.postMessage({source:"nventr-agent",type:"windowState",payload:e},"*")},R=()=>{w.windowState=w.windowState===s?n:s,(w.windowState===s?b:f)()},T=()=>{w.windowState=w.windowState===u?n:u,(w.windowState===u?y:f)()},W=({}={})=>{p.animate([{opacity:0,transform:"scale(0.92)"},{opacity:1,transform:"scale(1)"}],{duration:300,easing:"cubic-bezier(0.2, 0, 0, 1)",fill:"forwards"})};let I=()=>{w.visible||(p.animate([{opacity:0},{opacity:1}],{duration:800,easing:"linear",fill:"forwards"}),w.visible=!0)},U=()=>{p.getAnimations().forEach(e=>e.cancel()),p.remove(),w.rendered=!1,w.visible=!1},z=()=>{switch(g(p,{bottom:w.margin+"px",right:w.margin+"px",borderRadius:w.radius+"px",height:w.height+"px",width:w.width+"px","z-index":w.zIndex}),w.windowState){case s:b();break;case u:y()}I()};e=()=>{var e=document.getElementById("nventr-agent");if(!e)return{};let a=new URL(e.src);e=(e,t)=>{let n=!1;if(a.searchParams.has(e)){var o=a.searchParams.get(e);switch(o){case"":case"1":case"true":n=!0;break;case"false":case"0":n=!1;break;default:null===t&&(n=o)}""===a.searchParams.get(e)&&(n=!0)}else n=t;return n};return{id:e("id",null),dev:e("dev",!1),uat:e("uat",!1),fullscreen:e("fullscreen",!1),collapse:e("collapse",!1),render:e("render",!0),margin:e("margin",null),zIndex:e("zIndex",null),radius:e("radius",null),theme:e("theme",null),conversationUuid:e("conversationUuid",null)}};let N=(e={})=>{var t=e.dev||!1,n=e.uat||!1,o=e.id||e.agentAccessKey;if(!o)return console.warn("Nventr Agent warning. No agent access key provided. Please add the id parameter or use nventrAgent.render({ id: [AGENT ACCESS KEY] })."),!1;U(),e.onRendered&&(w.onRenderedCallback=e.onRendered),e.webhookAccessToken&&(w.webhookAccessToken=e.webhookAccessToken),e.metadata&&(w.metadata=e.metadata),e.onAction&&(w.onAction=e.onAction),e.onActions&&(w.onActions=e.onActions),e.margin&&(w.margin=e.margin),e.radius&&(w.radius=e.radius),e.height&&(w.height=e.height),e.width&&(w.width=e.width),e.zIndex&&(w.zIndex=e.zIndex),e.conversationUuid&&(w.conversationUuid=e.conversationUuid),p.id="nventrAgentWrapper_"+Date.now(),g(p,{...B.wrapper,bottom:w.margin+"px",right:w.margin+"px",borderRadius:w.radius+"px",height:w.height+"px",width:w.width+"px"}),g(c,{...B.handle,width:w.width-64+"px"}),c.onmousedown=x,g(r,B.collapseButton),r.onclick=R,g(d,B.fullscreenButton),d.onclick=T,g(l,{...B.fabButton,display:"none"}),l.onclick=R,g(h,{...B.iframe,borderRadius:w.radius+"px"});var a=[],a=(e.theme&&a.push("theme="+e.theme),e.radius&&a.push("radius="+e.radius),e.conversationUuid&&a.push("conversationUuid="+e.conversationUuid),a.length?"&"+a.join("&"):"");let i="https://agent.inventr.ai?agentAccessKey="+o+a;return n?i="https://uat-agent.inventr.ai?agentAccessKey="+o+a:t&&(i="https://dev-agent.inventr.ai?agentAccessKey="+o+a),h.src=i,h.allow="microphone",h.allowusermedia="true",p.appendChild(h),p.appendChild(c),p.appendChild(r),p.appendChild(d),p.appendChild(l),document.body.appendChild(p),!0===e.collapse?w.windowState=s:!0===e.fullscreen&&(w.windowState=u),!0},B={wrapper:{backgroundColor:"rgba(0, 0, 0, 0)",position:"fixed",zIndex:"10",opacity:"0",boxShadow:v,borderWidth:"0px",overflow:"hidden"},handle:{cursor:"grab",position:"absolute",top:"0px",height:"32px",opacity:"0"},collapseButton:{cursor:"pointer",position:"absolute",top:"0px",right:"32px",height:"32px",width:"32px",opacity:"0"},fabButton:{"z-Index":"11",cursor:"pointer",position:"absolute",top:"0px",right:"0px",bottom:"0px",left:"0px",opacity:"0"},fullscreenButton:{cursor:"pointer",position:"absolute",top:"0px",right:"0px",height:"32px",width:"32px",opacity:"0"},iframe:{position:"absolute",height:"100%",width:"100%",top:"0px",right:"0px",bottom:"0px",left:"0px",borderRadius:"4px",borderWidth:"0px",overflow:"hidden"}};return e().render&&N(e()),{render:e=>{N(e)},setWebhookAccessToken:e=>E(e),removeWebhookAccessToken:()=>E(null),setConversationUuid:e=>S(e),removeConversationUuid:()=>S(null),addActionListener:(e,t)=>{let n={name:e,callback:t};return i.push(n),{remove:()=>{var e=i.indexOf(n);i.splice(e,1)}}},onAction:e=>{w.onAction=e},onActions:e=>{w.onActions=e},onRendered:e=>{w.onRenderedCallback=e,w.rendered&&w.onRenderedCallback()},restore:()=>f(),collapse:()=>b(),fullscreen:()=>y(),show:()=>I(),hide:()=>{w.visible&&(p.animate([{opacity:1},{opacity:0}],{duration:800,easing:"linear",fill:"forwards"}),w.visible=!1)},margin:e=>{w.margin=e},radius:e=>{w.radius=e},theme:e=>{w.theme=e},remove:()=>U()}}let nventrAgent=window.nventrAgent||init();window.nventrAgent=nventrAgent;export default window.inventrAgent=nventrAgent;