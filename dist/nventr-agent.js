function init(){let r=document.createElement("div"),d=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),s=document.createElement("iframe"),l=document,c=36,e="NONE",p="COLLAPSED",h="FULLSCREEN",u=[],w={rendered:!1,onRendered:null,onAction:null,onActions:null,webhookAccessToken:null,height:448,width:352,margin:16,radius:4,zIndex:10,windowState:e},m=(window.addEventListener("message",function(e){if(e&&e.data&&"nventr-agent"===e.data.source){let n=e=>({name:e.name,value:e.value?JSON.parse(e.value):null});let o=(t,n)=>{u.forEach(e=>{e.name===t&&e.callback(n)}),w.onAction&&w.onAction(t,n)};switch(e.data.type){case"action":if(!e.data.payload||!e.data.payload.name)return!1;var a=n(e.data.payload);o(a.name,a.value);break;case"actions":if(!e.data.payload||!e.data.payload.length)return!1;a=e.data.payload.map(e=>n(e)).filter(e=>e&&e.name);if(!a.length)return!1;w.onActions&&w.onActions(a),a.forEach(({name:e,value:t})=>{o(e,t)});break;case"rendered":let t=e.data.payload;["margin","radius","height","width","zIndex"].forEach(e=>{e in t&&null!==t[e]&&!isNaN(t[e])&&(w[e]=parseInt(t[e]))}),w.rendered=!0,w.onRenderedCallback&&w.onRenderedCallback(),w.webhookAccessToken&&v(w.webhookAccessToken),k()}}}),(t,n)=>Object.keys(n).forEach(e=>t.style[e]=n[e])),g=e=>{e.preventDefault(),e.stopPropagation()},x=e=>{if(w.windowState!==h){g(e);let o=e.clientX,a=e.clientY,i=w.windowState===p?c:w.height,t=(s.style.pointerEvents="none",d.onmousedown=null,e=>{g(e);let t=r.offsetTop-(a-e.clientY),n=r.offsetLeft-(o-e.clientX);o=e.clientX,a=e.clientY,t<0&&(t=0),(n=n<0?0:n)+w.width>window.innerWidth&&(n=window.innerWidth-w.width),t+i>window.innerHeight&&(t=window.innerHeight-i),r.style.top=t+"px",r.style.left=n+"px"}),n=e=>{g(e),l.removeEventListener("mouseup",n),l.removeEventListener("mousemove",t),l.removeEventListener("mouseleave",n),d.onmousedown=x,s.style.pointerEvents="auto"};l.addEventListener("mouseup",n),l.addEventListener("mousemove",t),l.addEventListener("mouseleave",n),e.preventDefault}},t=()=>{r.style.height=c+"px",r.style.width=w.width+"px",r.style.top=null,r.style.left=null,r.style.bottom=w.margin+"px",r.style.right=w.margin+"px",y(p)},n=()=>{r.style.height=w.height+"px",r.style.width=w.width+"px",r.style.top=null,r.style.left=null,r.style.bottom=w.margin+"px",r.style.right=w.margin+"px",y(e)},o=()=>{r.style.width="auto",r.style.height="auto",r.style.width="auto",r.style.height="auto",r.style.top=w.margin+"px",r.style.left=w.margin+"px",r.style.bottom=w.margin+"px",r.style.right=w.margin+"px",y(h)},v=e=>{w.webhookAccessToken=e,w.rendered&&s.contentWindow.postMessage({source:"nventr-agent",type:"webhookAccessToken",payload:e},"*")},y=e=>{w.windowState=e,s.contentWindow.postMessage({source:"nventr-agent",type:"windowState",payload:e},"*")},f=()=>{w.windowState=w.windowState===p?e:p,(w.windowState===p?t:n)()},b=()=>{w.windowState=w.windowState===h?e:h,(w.windowState===h?o:n)()},A=()=>{r.getAnimations().forEach(e=>e.cancel()),r.remove(),w.rendered=!1},k=()=>{switch(m(r,{bottom:w.margin+"px",right:w.margin+"px",borderRadius:w.radius+"px",height:w.height+"px",width:w.width+"px","z-index":w.zIndex}),w.windowState){case p:t();break;case h:o()}r.animate([{opacity:0},{opacity:1}],{duration:800,easing:"linear",fill:"forwards"})};var E=()=>{var e=document.getElementById("nventr-agent");if(!e)return{};let a=new URL(e.src);e=(e,t)=>{let n=!1;if(a.searchParams.has(e)){var o=a.searchParams.get(e);switch(o){case"":case"1":case"true":n=!0;break;case"false":case"0":n=!1;break;default:null===t&&(n=o)}""===a.searchParams.get(e)&&(n=!0)}else n=t;return n};return{id:e("id",null),dev:e("dev",!1),fullscreen:e("fullscreen",!1),collapse:e("collapse",!1),render:e("render",!0),margin:e("margin",null),zIndex:e("zIndex",null),radius:e("radius",null),theme:e("theme",null)}};let S=(e={})=>{var t=e.dev||!1,n=e.id||e.agentAccessKey;if(!n)return console.warn("Nventr Agent warning. No agent access key provided. Please add the id parameter or use nventrAgent.render({ id: [AGENT ACCESS KEY] })."),!1;A(),e.onRendered&&(w.onRenderedCallback=e.onRendered),e.webhookAccessToken&&(w.webhookAccessToken=e.webhookAccessToken),e.onAction&&(w.onAction=e.onAction),e.onActions&&(w.onActions=e.onActions),e.margin&&(w.margin=e.margin),e.radius&&(w.radius=e.radius),e.height&&(w.height=e.height),e.width&&(w.width=e.width),e.zIndex&&(w.zIndex=e.zIndex),r.id="nventrAgentWrapper_"+Date.now(),m(r,{...C.wrapper,bottom:w.margin+"px",right:w.margin+"px",borderRadius:w.radius+"px",height:w.height+"px",width:w.width+"px"}),m(d,{...C.handle,width:w.width-64+"px"}),d.onmousedown=x,m(a,C.collapseButton),a.onclick=f,m(i,C.fullscreenButton),i.onclick=b,m(s,{...C.iframe,borderRadius:w.radius+"px"});var o=[],o=(e.theme&&o.push("theme="+e.theme),e.radius&&o.push("radius="+e.radius),o.length?"&"+o.join("&"):"");return s.src=t?"https://dev-agent.inventr.ai?agentAccessKey="+n+o:"https://agent.inventr.ai?agentAccessKey="+n+o,s.allow="microphone",s.allowusermedia="true",r.appendChild(s),r.appendChild(d),r.appendChild(a),r.appendChild(i),document.body.appendChild(r),!0===e.collapse?w.windowState=p:!0===e.fullscreen&&(w.windowState=h),!0},C={wrapper:{backgroundColor:"rgba(0, 0, 0, 0)",position:"fixed",zIndex:"10",opacity:"0",boxShadow:"0px 1px 10px 1px rgba(0, 0, 0, .2)",borderWidth:"0px",overflow:"hidden"},handle:{cursor:"grab",position:"absolute",top:"0px",height:"32px",opacity:"0"},collapseButton:{cursor:"pointer",position:"absolute",top:"0px",right:"32px",height:"32px",width:"32px",opacity:"0"},fullscreenButton:{cursor:"pointer",position:"absolute",top:"0px",right:"0px",height:"32px",width:"32px",opacity:"0"},iframe:{position:"absolute",height:"100%",width:"100%",top:"0px",right:"0px",bottom:"0px",left:"0px",borderRadius:"4px",borderWidth:"0px",overflow:"hidden"}};return E().render&&S(E()),{render:e=>{S(e)},setWebhookAccessToken:e=>v(e),removeWebhookAccessToken:()=>v(null),addActionListener:(e,t)=>{let n={name:e,callback:t};return u.push(n),{remove:()=>{var e=u.indexOf(n);u.splice(e,1)}}},onAction:e=>{w.onAction=e},onActions:e=>{w.onActions=e},onRendered:e=>{w.onRenderedCallback=e,w.rendered&&w.onRenderedCallback()},restore:()=>n(),collapse:()=>t(),fullscreen:()=>o(),margin:e=>{w.margin=e},radius:e=>{w.radius=e},theme:e=>{w.theme=e},remove:()=>A()}}let nventrAgent=window.nventrAgent||init();window.nventrAgent=nventrAgent;export default window.inventrAgent=nventrAgent;